
<!DOCTYPE html>
<html lang="en" data-figures="" class="page">
  <head>
<title>Getting Along with the OpenShift Machine Config Operator | Purplecarrot</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="Understanding the OpenShift Machine Config Operator, and fixing it when things go wrong.">
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="Getting Along with the OpenShift Machine Config Operator" />
<meta property="og:url" content="https://purplecarrot.co.uk/post/2021-12-19-machineconfigoperator/" />
<meta property="og:title" content="Getting Along with the OpenShift Machine Config Operator" />
<meta property="og:description" content="Understanding the OpenShift Machine Config Operator, and fixing it when things go wrong." />
<meta property="og:image" content="https://purplecarrot.co.uk/images/thumbnails/openshift.png" />

<link rel="apple-touch-icon" sizes="180x180" href="https://purplecarrot.co.uk/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://purplecarrot.co.uk/icons/favicon-32x32.png">
<link rel="manifest" href="https://purplecarrot.co.uk/icons/site.webmanifest">

<link rel="canonical" href="https://purplecarrot.co.uk/post/2021-12-19-machineconfigoperator/">

<script async src="https://www.googletagmanager.com/gtag/js?id=G-3M4X88WERG"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-3M4X88WERG', { 'anonymize_ip': false });
}
</script>



    

    
    
    <link rel="preload" href="https://purplecarrot.co.uk/css/styles.ee3b9488ef041710052f5c22837bf044d13ac251377aac559881157179229b04be4ae0027ad7b3c9b0cf469d0b37c82b8fcc5956709efe67b73f0e08a76bba3d.css" integrity = "sha512-7juUiO8EFxAFL1wig3vwRNE6wlE3eqxVmIEVcXkimwS&#43;SuACetezybDPRp0LN8grj8xZVnCe/me3Pw4Ip2u6PQ==" as="style" crossorigin="anonymous">
    <link rel="preload" href="https://purplecarrot.co.uk/js/bundle.min.eb436f5fa53f940b87c5fff22b7a5ff21d8e1a755411de5197a962bc1ceab4491d6492b2d9cb6e2763c8d66098d9045411b988628217da75dc160b3e1b5766a2.js" as="script" integrity=
    "sha512-60NvX6U/lAuHxf/yK3pf8h2OGnVUEd5Rl6livBzqtEkdZJKy2ctuJ2PI1mCY2QRUEbmIYoIX2nXcFgs&#43;G1dmog==" crossorigin="anonymous">

    
    <link rel="stylesheet" type="text/css" href="https://purplecarrot.co.uk/css/styles.ee3b9488ef041710052f5c22837bf044d13ac251377aac559881157179229b04be4ae0027ad7b3c9b0cf469d0b37c82b8fcc5956709efe67b73f0e08a76bba3d.css" integrity="sha512-7juUiO8EFxAFL1wig3vwRNE6wlE3eqxVmIEVcXkimwS&#43;SuACetezybDPRp0LN8grj8xZVnCe/me3Pw4Ip2u6PQ==" crossorigin="anonymous">
    
  </head>
  
  
    
  
  <body data-code="25" data-lines="false" id="documentTop">

<header class="nav_header" >
  <nav class="nav"><a href='https://purplecarrot.co.uk/' class="nav_brand nav_item" title="Purplecarrot">
  <img src="https://purplecarrot.co.uk/logos/logo.png" class="logo" alt="Purplecarrot">
  <div class="nav_close">
    <div><svg class="icon">
  <use xlink:href="#open-menu"></use>
</svg><svg class="icon">
  <use xlink:href="#closeme"></use>
</svg></div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/" class="nav_item" title="Home">Home </a>
  </div>
  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/categories/containers" class="nav_item" title="Containers">Containers </a>
  </div>
  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/categories/development" class="nav_item" title="Development">Development </a>
  </div>
  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/categories/linux" class="nav_item" title="Linux">Linux </a>
  </div>
  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/" class="nav_item" title="Links">Links <img src='https://purplecarrot.co.uk/icons/caret-icon.svg' alt="icon" class="nav_icon"></a>
    <div class="nav_sub">
      <span class="nav_child"></span>
        <a href="https://github.com/purplecarrot" class="nav_child nav_item" title="GitHub">GitHub</a>
        <a href="https://github.com/purplecarrot/quickref" class="nav_child nav_item" title="QuickRef">QuickRef</a>
    </div>
  </div>
  <div class="nav_parent">
    <a href="https://purplecarrot.co.uk/about/" class="nav_item" title="About">About </a>
  </div>
      
<div class='follow'>
  <a href="https://github.com/purplecarrot">
    <svg class="icon">
  <use xlink:href="#github"></use>
</svg>
  </a>
    
  <a href="https://purplecarrot.co.uk/index.xml">
    <svg class="icon">
  <use xlink:href="#rss"></use>
</svg>
  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">Getting Along with the OpenShift Machine Config Operator</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <use xlink:href="#calendar"></use>
</svg></span>
    <span class="post_date">
      Dec 19, 2021</span>
    <span class="post_time"> · 13 min read</span><span>&nbsp;· <a href='https://purplecarrot.co.uk/tags/kubernetes' title="Kubernetes" class="post_tag button button_translucent">Kubernetes
        </a><a href='https://purplecarrot.co.uk/tags/openshift' title="OpenShift" class="post_tag button button_translucent">OpenShift
        </a><a href='https://purplecarrot.co.uk/tags/linux' title="Linux" class="post_tag button button_translucent">Linux
        </a>
    </span>
    <span class="page_only">
  <div class="post_share">
    
    <a href="https://twitter.com/intent/tweet?text=Getting%20Along%20with%20the%20OpenShift%20Machine%20Config%20Operator&url=https%3a%2f%2fpurplecarrot.co.uk%2fpost%2f2021-12-19-machineconfigoperator%2f&tw_p=tweetbutton" class="twitter" title=" Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fpurplecarrot.co.uk%2fpost%2f2021-12-19-machineconfigoperator%2f&t=Getting%20Along%20with%20the%20OpenShift%20Machine%20Config%20Operator" class="facebook" title=" Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#facebook"></use>
</svg>
    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title=" LinkedIn" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
    </a>
    <a href="https://purplecarrot.co.uk/post/2021-12-19-machineconfigoperator/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <use xlink:href="#copy"></use>
</svg>
    </a>
  </div>
  
</span>
  </div>

    
    
    <h2>Overview</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-the-openshift-machine-config-operator">What is the OpenShift Machine Config Operator?</a></li>
    <li><a href="#understanding-the-machine-config-operator-mco">Understanding the Machine Config Operator (MCO)</a></li>
    <li><a href="#machineconfigs">MachineConfigs</a></li>
    <li><a href="#quick-health-check-of-mco">Quick Health Check of MCO</a></li>
    <li><a href="#monitoring-an-mco-update">Monitoring an MCO Update</a></li>
    <li><a href="#troubleshooting-degraded-nodes">Troubleshooting Degraded Nodes</a>
      <ul>
        <li><a href="#unexpected-on-disk-state---content-mismatch-for-file">Unexpected on-disk state - content mismatch for file</a></li>
        <li><a href="#error-running-rpm-ostree">Error running rpm-ostree</a></li>
        <li><a href="#forcing-a-pivot">Forcing a Pivot</a></li>
        <li><a href="#forcing-a-node-to-use-a-specific-machineconfig">Forcing a Node to Use a Specific MachineConfig</a></li>
      </ul>
    </li>
    <li><a href="#pausing-mco-updates">Pausing MCO Updates</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
    <p>When I'm working with the Machine Config Operator (MCO) in OpenShift, and frequently typing <code>oc describe mcp</code> and <code>oc get mcp</code>, I'm often reminded of the MCP (Machine Control Program) in the film <a href="https://en.wikipedia.org/wiki/Tron">Tron</a>. I like the idea behind the MCO, and when it's working it's great, but perhaps this association in my mind is not only because of the shared acronym, but because you do sometimes feel you're fighting with it for control of your cluster!</p>
<h2 id="what-is-the-openshift-machine-config-operator">What is the OpenShift Machine Config Operator?</h2>
<p>The <a href="https://github.com/openshift/machine-config-operator">OpenShift Machine Config Operator</a> is a very powerful piece of software and an important part of the OpenShift Container Platform (OCP). It manages the Operating System versions, updates and configuration files of the master and worker nodes that make up an OpenShift cluster. Operating system configuration files such as NetworkManager config files, systemd units, sysctl files as well as kubelet config files and certificate bundles, are base64 encoded and held in <code>MachineConfig</code> resources inside Kubernetes itself.</p>
<p>This might not sound that interesting in the context of today's public cloud service providers IaaS solutions, but when the nodes are running on HP and Dell bare metal physical servers in private disconnected data centres, having a software operator like this - which is run and managed using native Kubernetes primitives and commands - drastically reduces the SA workload required to manage and maintain multiple clusters made up of hundreds of bare metal physical servers</p>
<h2 id="understanding-the-machine-config-operator-mco">Understanding the Machine Config Operator (MCO)</h2>
<p>The MCO lives in the <em>openshift-machine-config-operator</em> project and is present in every OpenShift cluster. There are a number of different containers running in this namespace:</p>
<ul>
<li><strong>machine-config-operator</strong> - this is the main controller loop or ClusterOperator itself that deploys and manages everything else in this namespace.</li>
<li><strong>machine-config-server</strong> - provides the endpoint that nodes connect to in order to get their configuration files.</li>
<li><strong>machine-config-controller</strong> - co-ordinates upgrades and manages the lifecycle of nodes in the cluster by rendering (generating) <code>MachineConfigs (mc)</code>, managing <code>MachineConfigPools (mcp)</code> and by co-ordinating with the <em>machine-config-daemon</em> running on each node to keep all the nodes up to date with the correct configuration.</li>
<li><strong>machine-config-daemon</strong> - responsible for updating nodes to a given <code>MachineConfig</code> when requested to by the machine-config-controller. This runs as a DaemonSet so there is one pod per node in the cluster.</li>
</ul>
<p>The terminal output below illustrates these pods running in the <em>openshift-machine-config-operator</em> project in an OpenShift cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">$ oc get pods -n openshift-machine-config-operator -o wide
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAME                                         READY   STATUS    RESTARTS   AGE   IP              NODE       NOMINATED NODE   READINESS GATES
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">machine-config-controller-7c4975f766-gbnh2   1/1     Running   1          20h   10.129.0.27     server01   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">machine-config-daemon-2kt5g                  2/2     Running   2          18h   192.162.1.203   server03   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">machine-config-daemon-jmhll                  2/2     Running   6          54d   192.168.1.206   server06   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">machine-config-daemon-rzwhv                  2/2     Running   6          54d   192.168.1.202   server02   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">machine-config-daemon-vqphs                  2/2     Running   24         54d   192.168.1.201   server01   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">machine-config-daemon-xqjgk                  2/2     Running   2          17h   192.168.1.205   server05   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">machine-config-operator-66f4cd998f-v8cfg     1/1     Running   1          20h   10.129.0.40     server01   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln">10</span><span class="cl">machine-config-server-5hlsd                  1/1     Running   12         54d   192.168.1.101   server01   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln">11</span><span class="cl">machine-config-server-dfvg8                  1/1     Running   3          54d   192.168.1.102   server02   &lt;none&gt;           &lt;none&gt;
</span></span><span class="line"><span class="ln">12</span><span class="cl">machine-config-server-tr2fd                  1/1     Running   11         54d   192.168.1.103   server03   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><h2 id="machineconfigs">MachineConfigs</h2>
<p>So how does an update or change to a systemd unit file used to start the kubelet on a node make it to the OS disk of a node that requires it?</p>
<p>One of the core utilities underpinning the MCO is <a href="https:/github.com/coreos/ignition">Ignition</a>. When RedHat acquired the CoreOS company in 2018, they merged the best parts of CoreOS, Red Hat Linux and Red Hat Atomic operating systems and the resulting product was named Red Hat CoreOS (RHCOS). This is the OS that runs on the master and worker nodes in an OpenShift cluster.</p>
<p>All the OS configuration files a node requires are encoded and encapsulated in ignition files. The <em>machine-config-controller</em> collates all these various snippets and OS configuration files each node requires, and then renders (generates) <code>MachineConfig</code> kubernetes resources with all the files.</p>
<p>The command below, shows the <code>MachineConfigs</code> available in an OpenShift cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">$ oc get mc --sort-by=&#39;{.metadata.creationTimestamp}&#39;
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAME                                               GENERATEDBYCONTROLLER                      IGNITIONVERSION   AGE
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">99-worker-ssh                                                                                 3.2.0             216d
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">99-master-ssh                                                                                 3.2.0             216d
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">00-master                                          a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">01-master-kubelet                                  a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">01-worker-container-runtime                        a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">01-master-container-runtime                        a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">99-master-generated-registries                     a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln">10</span><span class="cl">00-worker                                          a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln">11</span><span class="cl">99-worker-generated-registries                     a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln">12</span><span class="cl">01-worker-kubelet                                  a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             216d
</span></span><span class="line"><span class="ln">13</span><span class="cl">rendered-master-0a540fd2eb85335cab8066f0bb407d5b   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             216d
</span></span><span class="line"><span class="ln">14</span><span class="cl">rendered-worker-9da78a560e7fa3c0cbd53d2bf0c17941   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             216d
</span></span><span class="line"><span class="ln">15</span><span class="cl">rendered-master-248f9034db99de75517a88a2ae8d29e2   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             215d
</span></span><span class="line"><span class="ln">16</span><span class="cl">rendered-worker-e323d4623ccb8cb71a4953f4ca81f8a4   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             215d
</span></span><span class="line"><span class="ln">17</span><span class="cl">rendered-worker-5599b4631efd88b5834f0844bec5ce83   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             203d
</span></span><span class="line"><span class="ln">18</span><span class="cl">rendered-master-8e5868011cc53d9697ac9dda69a64b39   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             203d
</span></span><span class="line"><span class="ln">19</span><span class="cl">rendered-worker-77e79ef013b565633a4d04da28f7dda4   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             203d
</span></span><span class="line"><span class="ln">20</span><span class="cl">rendered-master-c40185b01423956d1146b7dea0a3e265   116603ff3d7a39c0de52d7d16fe307c8471330a0   3.2.0             203d
</span></span><span class="line"><span class="ln">21</span><span class="cl">rendered-worker-dee67e9dc2ba77876de8bc8d045740dd   c76785d62cc28ddf3390c865c9e999a02248cd84   3.2.0             57d
</span></span><span class="line"><span class="ln">22</span><span class="cl">rendered-master-3fcbbc2dcbddc79435994c98b655b192   c76785d62cc28ddf3390c865c9e999a02248cd84   3.2.0             57d
</span></span><span class="line"><span class="ln">23</span><span class="cl">rendered-worker-7373393797c4c7e5ae500ff51ba234a9   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             55d
</span></span><span class="line"><span class="ln">24</span><span class="cl">rendered-master-40ad8d11cc05c7079ee8f3bfa6df5540   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             55d
</span></span><span class="line"><span class="ln">25</span><span class="cl">rendered-worker-53656729c24a74935907c4fba2adc90a   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             54d
</span></span><span class="line"><span class="ln">26</span><span class="cl">rendered-master-1e2f18449f36cad8c9618c264d5cdc10   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             54d
</span></span><span class="line"><span class="ln">27</span><span class="cl">rendered-worker-82df13b281ba3ddb9ba2e8811ef7957c   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             14d
</span></span><span class="line"><span class="ln">28</span><span class="cl">rendered-master-7ed9a47c85ff478b341adaa20a55e942   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             14d
</span></span><span class="line"><span class="ln">29</span><span class="cl">rendered-master-98968a4a639e3efad0436d19d4a6c93f   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             14d
</span></span><span class="line"><span class="ln">30</span><span class="cl">rendered-worker-65ec18c5a3e4ebbf5f8ef459fb3c50b2   a537783ea4a0cd3b4fe2a02626ab27887307ea51   3.2.0             14d
</span></span></code></pre></div><p>In this command output, you can see that 216 days ago when the cluster was first installed, initial <code>MachineConfigs</code> were rendered - one for the master nodes (rendered-master-0a540f..) in the cluster, and one for the worker nodes (rendered-worker-9da78a...). Whilst these two <code>MachineConfigs</code> share common OS configuration files, there are also lots of differences and so they are managed separately for each <code>MachineConfigPool</code>.</p>
<p>Since the initial install, we can see at various intervals, new <code>MachineConfig</code> objects were rendered by the <em>machine-config-controller</em>. Each new rendered- <code>MachineConfig</code> is from when upgrades were made to the OpenShift cluster (because an OpenShift update may have updated an OS setting in say <code>/etc/crio/crio.conf</code>)</p>
<p>As well as OCP version updates forcing updates, you can also manually edit <code>MachineConfigs</code> to modify or add you own OS config files. For what it's worth, I did have to do this with early OpenShift 4.1/4.2 versions, where I modified NTP and SSHD config files for custom settings and to modify the ca-bundle.crt as a workaround as early versions had issues with private CAs. But since those early versions, I have not had need to make any changes - the MCO just manages the complete OS lifecycle of the node.</p>
<p>When a new <code>MachineConfig</code> is generated, the <em>machine-config-controller</em> will work with the <em>machine-config-daemon</em> running on each node to reboot it and have it apply the latest ignition configuration held within the <code>MachineConfig</code>.</p>
<p>When a node boots Red Hat CoreOS, <em>ignition</em> connects to the <em>machine-config-server</em> endpoint <code>https://&lt;cluster-api&gt;:22623/config/master</code> (or <code>/config/worker</code> for worker nodes, or <code>/config/&lt;machine-config-pool&gt;</code>) and applies the <em>Ignition</em> config to the node.</p>
<h2 id="quick-health-check-of-mco">Quick Health Check of MCO</h2>
<p>Most of the time, the MCO works very well. However, as with any highly automated process, on occasions it does go wrong. The first thing to be aware of with MCO is that you have to keep a close eye on it, particularly when it's rolling out updates. At a high level, the quickest ways to do this is by looking at status of the the ClusterOperator's status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc get co machine-config
</span></span><span class="line"><span class="ln">2</span><span class="cl">NAME             VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE
</span></span><span class="line"><span class="ln">3</span><span class="cl">machine-config   4.8.10    True        False         False       14d
</span></span></code></pre></div><p>Here we can see that the MCO is <strong>AVAILABLE=True</strong>. This is good, and you nearly always want to see this. If it's <strong>False</strong>, something is very wrong with the cluster, or more likely perhaps, the cluster is in the middle of an OCP upgrade and the MCO pod is restarting on a different node.</p>
<p>If <strong>PROGRESSING=False</strong> is shown, that means that the MCO has no updates to rollout, and that the nodes in your cluster are all up to date and running on the latest OS version and using all the OS config files from the <code>MachineConfig</code>. If this is set to <strong>False</strong>, then that means the <em>machine-config-controller</em> is busy working through an update and asking the <em>machine-config-daemons</em> on each node to reboot the node and apply a <code>MachineConfig</code>.</p>
<p>For a healthy MCO, you also want to see <strong>DEGRADED=False</strong>. If you see this as <strong>True</strong>, then your MCO has a problem that usually requires manual intervention, and some of the key reasons that I've seen for this condition are documented below.</p>
<p>As well as looking at the overview status of the <code>ClusterOperator</code> resource, another way you can see the health of the MCO at a glance is to look at its <code>MachineConfigPools</code>. In a healthy cluster, these pools will show <strong>UPDATED=True</strong> and <strong>DEGRADED=False</strong>. If <strong>UPDATING=True</strong> is set, the <em>machine-config-controller</em> is in the middle of rolling out an update:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc get mcp
</span></span><span class="line"><span class="ln">2</span><span class="cl">NAME     CONFIG                                             UPDATED   UPDATING   DEGRADED   MACHINECOUNT   READYMACHINECOUNT   UPDATEDMACHINECOUNT   DEGRADEDMACHINECOUNT   AGE
</span></span><span class="line"><span class="ln">3</span><span class="cl">master   rendered-master-98968a4a639e3efad0436d19d4a6c93f   True      False      False      3              3                   3                     0                      216d
</span></span><span class="line"><span class="ln">4</span><span class="cl">worker   rendered-worker-53656729c24a74935907c4fba2adc90a   True      False      False      3              3                   3                     0                      216d
</span></span></code></pre></div><h2 id="monitoring-an-mco-update">Monitoring an MCO Update</h2>
<p>If your MCO is updating (<strong>PROGRESSING=True</strong>, <strong>UPDATING=True</strong>), then you can monitor its progress by watching the logs of the <em>machine-config-controller</em> pod.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc logs -l k8s-app=machine-config-controller -n openshift-machine-config-operator
</span></span></code></pre></div><p>In the logs from this pod, you'll see nodes in the cluster sequentially being cordoned (made <code>schedulable=False</code>) and then rebooted. Whilst rebooting and applying the new configuration, they will be seen as <code>NotReady</code> status in <code>oc get nodes</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc get nodes
</span></span><span class="line"><span class="ln">2</span><span class="cl">NAME       STATUS                        ROLES           AGE    VERSION
</span></span><span class="line"><span class="ln">3</span><span class="cl">server01   Ready                         master,worker   217d   v1.21.1+9807387
</span></span><span class="line"><span class="ln">4</span><span class="cl">server02   NotReady,SchedulingDisabled   master,worker   217d   v1.21.1+9807387
</span></span><span class="line"><span class="ln">5</span><span class="cl">server03   Ready                         master,worker   217d   v1.21.1+9807387
</span></span><span class="line"><span class="ln">6</span><span class="cl">server04   NotReady,SchedulingDisabled   worker          203d   v1.21.1+9807387
</span></span><span class="line"><span class="ln">7</span><span class="cl">server05   Ready                         worker          203d   v1.21.1+9807387
</span></span></code></pre></div><p>If something happens when the node reboots (eg it fails to DHCP, it can't boot because of a disk or grub error, fails to start the kubelet), the MCO rollout process will halt. You'll notice this because the node stays <code>NotReady</code> for longer than you'd expect and the status will become <em>degraded</em>. If this happens, you have to roll your sleeves up and work out why.</p>
<h2 id="troubleshooting-degraded-nodes">Troubleshooting Degraded Nodes</h2>
<p>The first place to look when troubleshooting a <em>degraded</em> node is its machine-config-daemon pod. In early OpenShift 4.x versions, there were also occasions when the reason for a degraded node was only apparent by looking in the Linux journald logs on the node itself. However in recent versions, I've not had to resort to journald logs because everything about an error has been available in the <em>machine-config-daemon</em> pod logs for the node. To find the correct <em>machine-config-daemon</em> pod for the node, you simply run <code>oc get pods -o wide</code>, or alternatively you could cut and paste the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ MCDPOD=$(oc get pods -l k8s-app=machine-config-daemon -o jsonpath=&#39;{.items[?(@.spec.nodeName==&#34;server01&#34;)].metadata.name&#39;)
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ oc logs $MCDPOD -c machine-config-daemon
</span></span></code></pre></div><p>Next, lets look at a few common reasons for a node being degraded.</p>
<h3 id="unexpected-on-disk-state---content-mismatch-for-file">Unexpected on-disk state - content mismatch for file</h3>
<p>If the files on a node's disk that are under control of the <code>MachineConfig</code> don't match the contents of those same files as specified in that <code>MachineConfig</code> (ie the <code>MachineConfig</code> specified in the node's <code>machineconfiguration.openshift.io/currentConfig</code> annotation), then the <em>machine-config-daemon</em> will refuse to apply the update and this will put the <code>MachineConfigPool</code> into a degraded state. You'll see a message event similar to this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Type:                  RenderDegraded
</span></span><span class="line"><span class="ln">2</span><span class="cl">Message:               Node server01 is reporting: &#34;unexpected on-disk state validating against rendered-worker-82df13b281ba3ddb9ba2e8811ef7957c: content mismatch for file \&#34;/etc/kubernetes/kubelet.conf\&#34;&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">Reason:                1 nodes are reporting degraded status on sync
</span></span><span class="line"><span class="ln">4</span><span class="cl">Status:                True
</span></span><span class="line"><span class="ln">5</span><span class="cl">Type:                  NodeDegraded
</span></span></code></pre></div><p>This happens when somebody has manually edited a file on a node. Although remember, there should be no reason or need for a sysadmin (SA) to edit files on RHCOS, but sometimes junior SAs or SAs not familiar with OpenShift might be tempted to edit OS config files using ssh/vim.</p>
<p>You can get an indication of this by looking at the <code>machineconfiguration.openshift.io/ssh</code> annotation on the node. If this is set to accessed, then a SA has ssh'd onto the node and could have perhaps changed something manually. Ordinarily (except see troubleshooting below), SA shouldn't be ssh'ing onto RHCOS nodes.</p>
<p>The easiest way to quickly fix this is to restore the config file from the <code>MachineConfig</code>. To do this, output the correct <code>MachineConfig</code> in full YAML, and then search for the path entry for the file being reported as having a content mismatch. Alternatively, copy and run the following commands to get the file contents:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ CURRENT_CONFIG=$(oc get node -o jsonpath=&#34;{.items[?(@.metadata.name==&#39;server01&#39;)].metadata.annotations[&#39;machineconfiguration\.openshift\.io/currentConfig&#39;]}&#34;)
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ oc get mc $CURRENT_CONFIG -o jsonpath=&#34;{.spec.config.storage.files[?(@.path==&#39;/etc/kubernetes/kubelet.conf)].contents.source}&#34; &gt; newkubelet.conf
</span></span></code></pre></div><p>Then you simply base64 decode (or urldecode) the file, and scp it back onto the degraded node in the correct location. This will overwrite the manual changes made to the file and restore it to what the MCO wants it to be. The MCO should then pick up that the <code>MachineConfig</code> now matches, and continue progressing with what it was doing.</p>
<h3 id="error-running-rpm-ostree">Error running rpm-ostree</h3>
<p>Red Hat CoreOS uses something called <a href="">rpm-ostree</a> which is a <em>&quot;hybrid image/package system&quot;</em>. It's basically an archive file that contain all the Linux software package (RPMS) that CoreOS requires and allows atomic upgrades (and downgrades) by being able to pivot between them. Sometimes this fails, and the node will become degraded. I've seen this fail for a couple of reasons - once with an issue where the node was unable to download an image from quay.io, and another time when a third party vendor (who wasn't familiar with how rpm-ostrees and Red Hat CoreOS worked) set the immutable ACL attribute on some of its files on the node, causing the node to fail drastically on each OS upgrade. The vendor has since removed these custom ACLs from their product after our experience.</p>
<p>The best way to fix this, if you can, is to correct the issue breaking the pivot. For example, by removing the immutable ACL on a system file. The Linux systemd journal on the node should help with identifying the error. If you still can't fix it, the last resort to fix this issue is to force a pivot.</p>
<h3 id="forcing-a-pivot">Forcing a Pivot</h3>
<p>If you can't get the node to update, you'll have to force it. To do this, you connect to the node and run the <code>machine-config-daemon pivot</code> command with the correct OS image SHA (find this from the errors in the logs to be sure you get the correct one!)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc debug node/server01
</span></span><span class="line"><span class="ln">2</span><span class="cl">Starting pod/server01-debug ...
</span></span><span class="line"><span class="ln">3</span><span class="cl">To use host binaries, run `chroot /host`
</span></span><span class="line"><span class="ln">4</span><span class="cl">Pod IP: 192.168.1.201
</span></span><span class="line"><span class="ln">5</span><span class="cl">If you don&#39;t see a command prompt, try pressing enter.
</span></span><span class="line"><span class="ln">6</span><span class="cl"># sh-4.4
</span></span><span class="line"><span class="ln">7</span><span class="cl"># chroot /host
</span></span><span class="line"><span class="ln">8</span><span class="cl"># /run/bin/machine-config-daemon pivot &#34;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:aaaabbbbccccdddd&#34;
</span></span></code></pre></div><h3 id="forcing-a-node-to-use-a-specific-machineconfig">Forcing a Node to Use a Specific MachineConfig</h3>
<p>As a last resort - and experience has shown it really is better to address any MCO issues in other ways before doing this - you can force a node to reboot and use a different <code>MachineConfig</code>. This is done by manually editing the machineconfiguration annotations on the Node object itself.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">oc patch node server01 --type merge --patch &#39;{&#34;metadata&#34;: {&#34;annotations&#34;: {&#34;machineconfiguration.openshift.io/currentConfig&#34;: &#34;render-worker-52656729c24a7493&#34;}}}&#39;
</span></span><span class="line"><span class="ln">2</span><span class="cl">oc patch node server01 --type merge --patch &#39;{&#34;metadata&#34;: {&#34;annotations&#34;: {&#34;machineconfiguration.openshift.io/desiredConfig&#34;: &#34;render-worker-52656729c24a7493&#34;}}}&#39;
</span></span><span class="line"><span class="ln">3</span><span class="cl">oc patch node server01 --type merge --patch &#39;{&#34;metadata&#34;: {&#34;annotations&#34;: {&#34;machineconfiguration.openshift.io/reason&#34;: &#34;&#34;}}}&#39;
</span></span><span class="line"><span class="ln">4</span><span class="cl">oc patch node server01 --type merge --patch &#39;{&#34;metadata&#34;: {&#34;annotations&#34;: {&#34;machineconfiguration.openshift.io/state&#34;: &#34;Done&#34;}}}&#39;
</span></span></code></pre></div><p>Then you have to connect to the node and touch a machine-config-daemon-force file. This will trigger the <em>machine-config-daemon</em> to do a reboot and to force the update to the <code>MachineConfig</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc debug node/server01
</span></span><span class="line"><span class="ln">2</span><span class="cl">[root@server01 core] chroot /host
</span></span><span class="line"><span class="ln">3</span><span class="cl">[root@server01 core] touch /run/machine-config-daemon-force
</span></span></code></pre></div><p>On occasion, you might not be able to connect to the node using an oc debug pod. I've seen this happen when a systemd unit running podman early in the boot process has had an image pull failure, and the debug pod is also not able to run when kubelet is not running properly, mean SSH is the only option.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ ssh core@server01
</span></span><span class="line"><span class="ln">2</span><span class="cl">[root@server01 core] touch /run/machine-config-daemon-force
</span></span></code></pre></div><h2 id="pausing-mco-updates">Pausing MCO Updates</h2>
<p>As described above, the MCO will automatically carry on the work of rebooting and managing your nodes if you let it. This is great, but does mean that nodes in the cluster can sometimes be rebooted without warning. Of course, true cloud-native Kubernetes ready applications should be running multiple replicas across nodes anyway, and this shouldn't normally be a problem.</p>
<p>However, should you wish to pause the MCO so that it doesn't automatically reboot nodes when you don't want it to, you can &quot;pause&quot; the worker pools by setting the <code>.spec.paused</code> field in the <code>MachineConfigPool</code>. For example, by running the following patch commands:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">$ oc patch mcp master --type merge --patch &#39;{&#34;spec&#34;:{&#34;paused&#34;: true}}&#39;
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ oc patch mcp worker --type merge --patch &#39;{&#34;spec&#34;:{&#34;paused&#34;: true}}&#39;
</span></span></code></pre></div><p>It should be noted that you shouldn't leave the <code>MachineConfigPool's</code> paused for long periods of times. This can cause issues for MCO if configuration updates combine with cluster cert rotation events. However, pausing them whilst the actual OCP control plane upgrade happens and then unpausing when you're ready for all the nodes to be rebooted can be very useful.</p>
<h2 id="summary">Summary</h2>
<p>The Machine Config Operator is a clever piece of software that significantly reduces workload of running and managing nodes in an OpenShift cluster. However, it's important for cluster administrators to understand how it works, and to be able to successfully recover it when any issues arise and it becomes degraded. Hopefully, this blog post will help you understand it a little better and to resolve any issues you encounter.</p>


  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    <h2 class="mt-4">Featured Posts</h2>
    <ul>
      <li>
        <a href="https://purplecarrot.co.uk/post/2021-10-30-breaking_into_your_openshift_cluster/" class="nav-link" title="Breaking into your OpenShift Cluster">Breaking into your OpenShift Cluster</a>
      </li>
      <li>
        <a href="https://purplecarrot.co.uk/post/2021-09-04-does_alpine-resolve_dns_properly/" class="nav-link" title="Does Alpine resolve DNS properly?">Does Alpine resolve DNS properly?</a>
      </li>
      <li>
        <a href="https://purplecarrot.co.uk/post/2020-09-12-tekton_and_knative/" class="nav-link" title="Practical Tekton">Practical Tekton</a>
      </li>
    </ul>
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://purplecarrot.co.uk/post/2021-10-30-breaking_into_your_openshift_cluster/" class="nav-link" title="Breaking into your OpenShift Cluster">Breaking into your OpenShift Cluster</a>
      </li>
      <li>
        <a href="https://purplecarrot.co.uk/post/2021-09-04-does_alpine-resolve_dns_properly/" class="nav-link" title="Does Alpine resolve DNS properly?">Does Alpine resolve DNS properly?</a>
      </li>
      <li>
        <a href="https://purplecarrot.co.uk/post/2020-09-12-tekton_and_knative/" class="nav-link" title="Practical Tekton">Practical Tekton</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">Categories</h2>
      <nav class="tags_nav">
        <a href='https://purplecarrot.co.uk/categories/development/' class="post_tag button button_translucent" title="development">
          DEVELOPMENT
          <span class="button_tally">14</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/categories/linux/' class="post_tag button button_translucent" title="linux">
          LINUX
          <span class="button_tally">14</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/categories/containers/' class="post_tag button button_translucent" title="containers">
          CONTAINERS
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/categories/misc/' class="post_tag button button_translucent" title="misc">
          MISC
          <span class="button_tally">3</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://purplecarrot.co.uk/tags/linux/' class="post_tag button button_translucent" title="linux">
          LINUX
          <span class="button_tally">17</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/python/' class="post_tag button button_translucent" title="python">
          PYTHON
          <span class="button_tally">10</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/development/' class="post_tag button button_translucent" title="development">
          DEVELOPMENT
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/git/' class="post_tag button button_translucent" title="git">
          GIT
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/gnome/' class="post_tag button button_translucent" title="gnome">
          GNOME
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/kubernetes/' class="post_tag button button_translucent" title="kubernetes">
          KUBERNETES
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/oneliners/' class="post_tag button button_translucent" title="oneliners">
          ONELINERS
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/openshift/' class="post_tag button button_translucent" title="openshift">
          OPENSHIFT
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/hardware/' class="post_tag button button_translucent" title="hardware">
          HARDWARE
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/openstack/' class="post_tag button button_translucent" title="openstack">
          OPENSTACK
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/security/' class="post_tag button button_translucent" title="security">
          SECURITY
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/bash/' class="post_tag button button_translucent" title="bash">
          BASH
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/index/' class="post_tag button button_translucent" title="index">
          INDEX
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://purplecarrot.co.uk/tags/oneliner/' class="post_tag button button_translucent" title="oneliner">
          ONELINER
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">All Tags</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://purplecarrot.co.uk/tags/bash/' class=" post_tag button button_translucent" data-position=1 title="bash">BASH<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/development/' class=" post_tag button button_translucent" data-position=3 title="development">DEVELOPMENT<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/git/' class=" post_tag button button_translucent" data-position=3 title="git">GIT<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/gnome/' class=" post_tag button button_translucent" data-position=3 title="gnome">GNOME<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/hardware/' class=" post_tag button button_translucent" data-position=2 title="hardware">HARDWARE<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/index/' class=" post_tag button button_translucent" data-position=1 title="index">INDEX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/kubernetes/' class=" post_tag button button_translucent" data-position=3 title="kubernetes">KUBERNETES<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/linux/' class=" post_tag button button_translucent" data-position=17 title="linux">LINUX<span class="button_tally">17</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/oneliner/' class=" post_tag button button_translucent" data-position=1 title="oneliner">ONELINER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/oneliners/' class=" post_tag button button_translucent" data-position=3 title="oneliners">ONELINERS<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/openshift/' class=" post_tag button button_translucent" data-position=3 title="openshift">OPENSHIFT<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/openstack/' class=" post_tag button button_translucent" data-position=2 title="openstack">OPENSTACK<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/pipelines/' class=" post_tag button button_translucent" data-position=1 title="pipelines">PIPELINES<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/python/' class=" post_tag button button_translucent" data-position=10 title="python">PYTHON<span class="button_tally">10</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/regex/' class=" post_tag button button_translucent" data-position=1 title="regex">REGEX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/security/' class=" post_tag button button_translucent" data-position=2 title="security">SECURITY<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/subversion/' class=" post_tag button button_translucent" data-position=1 title="subversion">SUBVERSION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://purplecarrot.co.uk/tags/tekton/' class=" post_tag button button_translucent" data-position=1 title="tekton">TEKTON<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/> 
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
</svg>


<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://purplecarrot.co.uk/icons/purplecarrot_icon.png' class="icon icon_2 transparent" alt="Purplecarrot">
    <p>&#xA9;purplecarrot.co.uk</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <use xlink:href="#arrow"></use>
</svg>
</a>

  </div>
</footer>

    <script type="text/javascript" src="https://purplecarrot.co.uk/js/bundle.min.eb436f5fa53f940b87c5fff22b7a5ff21d8e1a755411de5197a962bc1ceab4491d6492b2d9cb6e2763c8d66098d9045411b988628217da75dc160b3e1b5766a2.js" integrity="sha512-60NvX6U/lAuHxf/yK3pf8h2OGnVUEd5Rl6livBzqtEkdZJKy2ctuJ2PI1mCY2QRUEbmIYoIX2nXcFgs&#43;G1dmog==" crossorigin="anonymous"></script>
    
  </body>
</html>
